## Child Document -- File System Activity

#### Note to John

Eventually upgrade this to use
- `library(here)`
- `library(fs)`

###  USER INIPUT:  Enter your data directory

#### Note to John

I should make this either parameterized or an input to the kniter command line.  But until then...

### Identify Data Directory

User should place all attendance, waitlist, and cancelled files (if usd) in the 'data' subdirectory of the project directory.

```{r child_datadir}
data_dir <- "data"   # identify the data directory
```


###  Load Data Files
```{r child_load-data}
files <- as_tibble(str_split(list.files(data_dir), 
                             "_", simplify = T, 4))

files
```

### As Data Frame

Organize the filesystem data into a data frame

```{r child_file-system_df}
files <- files %>% 
  rename(prefix = V1, type = V2, id = V3, id2 = V4) %>% 
  mutate(id = if_else(id == "list", id2, id)) %>% 
  mutate(type = if_else(type == "wait", 
                        "wait_list", type)) %>% 
  mutate(download_date = str_sub(id, 8, -5)) %>% 
  mutate(course_id = str_sub(id, 1,7)) %>% 
  mutate(file_name = paste0(data_dir, 
                            "/", prefix, "_", 
                            type, "_", course_id, 
                            download_date, ".csv")) %>% 
  select(-id2, -id) %>% 
  arrange(type)

files
```


###  Attendees as a Data Frame

Generate metadata about the Attendees (confirmed) filename

```{r}
attendees_file_path <- files %>% 
  filter(type == "attendees") %>% 
  select(file_name, course_id)

attendees_file_path
```

